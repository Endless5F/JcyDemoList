36. 如何解答系统设计类问题？
    ```
    面试官视角：这道题想考察什么？
        1. 是否能够快速理解需求并对需求进行拆解(中级)
        2. 是否具备广泛的技术栈或知识面(高级)
        3. 是否能够深入挖掘需求给出良好的技术方案(高级)
        4. 是否具备良好的项目管理和领导能力(高级)
    题目剖析：
        1. 解答过程中与面试官要保持良好的沟通
        2. 如果系统足够大，则不需要解释太多细节
        3. 如果系统较小，最好辅以精妙的细节设计
    题目结论：
        项目诞生：
            提出想法-->可行性分析-->需求分析-->系统设计-->系统开发-->迭代维护-->系统重申
            面试官：提出想法
            候选人：需求分析-->系统设计
        系统设计步骤：
            需求：设计(项目需求)一个网络框架
            流程：关键就是打包请求、建立连接、发送请求、解析结果
            细节：请求和响应的数据结构适配能力、请求重试机制、异步处理能力、使用体验优化
        回顾：如何用Java实现Handler
            需求：一直Android Handler到Java平台
            流程：关键消息队列、死循环、阻塞和延时
            细节：是否需要支持底层、消息队列性能优化、消息实例池化
        系统设计三步走：
            1. 明确边界
            2. 打通流程
            3. 优化细节
        细节通用点：
            如何处理好并发：
                -是否有频繁的IO操作？
                -线程调度如何设计？比如：线程池，那么线程池上限是多少？根据什么限制设置线程池最大的线程数？CPU核心数
                -业务操作中异步程序如何设计？
                    * RxJava
                    * 协程(kotlin)
            网络如何接入？
                -是否需要频繁与服务端交互？
                -是否存在服务端主动推动消息的场景？
                -采用何种通信手段
                    * 长连接：高频交互，消息推送，维护复杂
                    * 短连接：低频交互，伪消息推送(短轮询(每个一段时间访问网络)、长轮询(访问后若无消息返回，则定时较长时间访问，比如：60s或120s等))
            保障安全性：
                -数据是否需要加密？
                -加密算法如何选择？
                    * 对称加密：密钥如何保存？
                    * 非对称加密：注意加密复杂度限制
                -应用安全性如何保证？
                    * 混淆
                    * 加固
                    * 对签名进行验证
            热修复与插件化：
                -热修复一般都需要，关键看方案选型
                    * 是否要求立即生效？若客户的设备打开头一直运行应用直到断电等，则需要立即生效。正常手机App可重启生效，比如：Tinker。
                    * 是否要求新增或者修改类？
                -插件化主要考虑体量
                    * 前期通常不需要插件化，但可未雨绸缪
                    * 是否融合了多条业务线，多团队协作？
            脚本化：
                -是否存在大量可模式化的逻辑：
                    * 游戏关卡
                    * 自定义的UI体系
                -是否存在大量需要经常调整的策略？
                    * 简单的参数调整无法满足
            可移植性：
                -是否存在复杂的平台不相关的逻辑？
                    * 如语音识别、OpenGL绘制逻辑
                    * 考虑C++开发
                -是否考虑移植UI？
                    * Flutter/React Native
            性能问题：
                -算法的时间和空间复杂度？
                -内存峰值是否偏大有无OOM可能？
                -CPU占有率是否持续较高？
                -耗电量是否居高不下？
            监控：
                -异常捕获以及状态保存恢复
                    * Java层异常捕获
                    * Native层异常捕获
                -性能监控
                -优化指标监控
                -运营数据监控
        思考过程：
            系统设计题没有标准答案
            深思熟虑地选择技术方案
            展示你的知识深度和广度
            思考过程比最终结果重要
        本节回顾：
            三个步骤：
                明确需求、打通流程、优化细节
            十个方面：
                并发网络与安全 脚本热修复插件
                性能监控可移植 思考过程是重点
    ```
37. 设计一个短视频App
    ```
    面试官视角：这道题想考察什么？
        1. 是否对短视频乃至视频行业业务有认识(中级)
        2. 是否有丰富的系统设计架构经验(高级)
        3. 是否对音视频相关技术领域有一定的积累(高级)
    题目剖析：
        1. 视频处理一定是重点
        2. App设计除业务本身外其余大多数相同
    题目结论：
        一星：
            明确需求变界：
                视频来源自有服务还是第三方？自有服务可同一格式，若是第三方则可能需要兼容多种格式
                视频由用户上传还是专业供应平台提供？视频上传和录制
                是否需要建立用户关系链？
                是否需要支持视频分享？
                是否需要建立支付系统方便打赏？
            打通关键流程：
                发布者：
                    录制视频
                    上传视频
                订阅者：
                    下载视频
                    播放视频
                基础组件：网络框架   播放器    相机    滤镜算法
                业务模块：视频    Feed流    社交    钱包    账户
        二星：
            播放器可移植
                公司平台级App    短视频细分App
                Android IOS    Android IOS
                    播      放      器
            滤镜脚本化：Camera--> OpenGL(Shader Script)--> View
            安全性：
                视频文件安全性，防止竞品非法获取
                    加密耗时影响体验，注意加密算法选取
                应用做好混淆和加固，防止篡改广告
        三星：
            成本优化
                视频编码格式：
                    指标             H.264       H.265
                    硬件支持          几乎全部     很少
                    文件大小          1           0.5
                    编解码耗时(硬件)   1           3-7
                建议：
                    针对热点视频(访问量大，带宽占比高)采用H.265
                    针对性能较好的机型动态切换软解H.265与硬解H.264
            播放优化
                MP4文件
                    包括：File Type Box(ftpy)、Movie Box(moov，索引)、Media Data Box(mdat，帧数据)，若moov中缺失一点，就会导致整个MP4无法播放
                    格式：
                        1. ftpy + moov + mdat，这种比较友好，可以边下载边播放
                        2. ftpy + mdat + moov，需要下载完才能播放，若在录制过程中moov由于异常缺失一点，就会整个文件损坏
                    格式优化：
                        ftpy + moov + mdat
                                ↑
                              Server
                                ↑
                        ftpy + mdat + moov
                    播放优化2：
                        播放器               播放行为(开始播放点)
                        ios                 一个GOP(推测)
                        Android 6.0及以下    5s视频数据
                        Android 7.0及以上    一个GOP(gop，意味着一组帧，从第一个关键帧到第二个关键帧之前)
                        基于FFmpeg自研播放器  关键帧(即一开始就可以播放)
            流量合作：专属流量，降低用户使用成本
    ```
38. 设计一个网络请求框架
    ```
    面试官视角：这道题想考察什么？
        1. 是否具备扎实的网络通信基础(中级)
        2. 是否有丰富的网络开发经验及需求细化能力(高级)
        3. 是否具备通用基础框架的架构设计能力(高级)
        4. 是否有框架使用体验优化的意识和思路(高级)
    题目剖析：
        1. 所有跟网络有关的，不要局限于Http
        2. 框架设计的几点注意事项
            依赖关系尽可能简单
            对外接口尽可能易用
            功能设计尽可能纯粹
    题目结论：
        一星：
            明确需求变界：
                单向请求还是双向请求？
                需要支持哪些应用层协议？
                是否要支持自定义协议扩展？
                是否需要支持异步能力？
                运行在什么平台上(可移植性)？
            打通关键流程：
                协议层：Http    WebSocket
                基础组件：连接管理   线程管理
            Tops：关键模式可绘制UML图
                Connection：
                    int write(byte[*] bytes, int start, int offset)
                    int read(byte[*] bytes)
                    void close()
                    void recycle() // 复用
                ConnectionManager：
                    Connection create(URL remoteUrl, boolean reuse)
        二星：
            为Http协议添加缓存机制：
                淘汰策略：默认采用LRU算法
                存储位置：内存、磁盘
                接口开发：全局开启或禁用缓存，策略、参数可配置
            增加全局数据拦截：
                Client    Interceptor    Server
            模拟服务：拦截器Interceptor
            日志工具：Client    日志输出    Server
            重试机制：失败越多，重试间隔越大，并且有上限次数。可设置最大重试次数，可指定频率衰减因子。
        三星：
            使用注解配置请求：Retrofit
            第三方扩展：RxJava、Kotlin
            代码设计模式：
                协议体构建使用Builder
                数据的传输与拦截使用责任链模式
                数据序列化类型支持使用适配器模式

            主要涉及的高级语法：
                注解：主要用于接口配置和参数解析
                泛型：主要用于数据类型的适配
                反射：读取注解信息、反序列化类型等等
            DNS增强：阿里云、腾讯云(HttpDNS，移动解析)
    ```